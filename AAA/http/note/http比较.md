# 6. http1.0，http1.1，http2.0区别


## http1.0

http1.0： 浏览器与服务器只保持短暂的连接，每次请求都需要与服务器建立一个TCP连接
服务器完成请求处理后立即断开TCP连接

每次与服务器交互都需要新开一个连接。

这种形式明显造成了性能上的缺陷。

如果需要建立长连接，需要设置一个connection字段 Connection:keep-alive 首部字段设置

## http 1.1
在HTTP1.1中，默认支持长连接（Connection: keep-alive），即在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟

HTTP 1.1还允许客户端不用等待上一次请求结果返回，就可以发出下一次请求，但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容，这样也显著地减少了整个下载过程所需要的时间

同时，HTTP1.1在HTTP1.0的基础上，增加更多的请求头和响应头来完善的功能，如下：

引入了更多的缓存控制策略，如If-Unmodified-Since, If-Match, If-None-Match等缓存头来控制缓存策略
引入range，允许值请求资源某个部分
引入host，实现了在一台WEB服务器上可以在同一个IP地址和端口号上使用不同的主机名来创建多个虚拟WEB站点
并且还添加了其他的请求方法：put、delete、options.


## http2.0

而HTTP2.0在相比之前版本，性能上有很大的提升，如添加了一个特性：

多路复用
二进制分帧
首部压缩
服务器推送

新的二进制格式：http1.x的解析是基于文本，基于文本协议的格式解析存在天然缺陷，文本的表现形式有多样性。要做到健壮性考虑的场景必然很多。二进制则不同，只认0和1的组合，http2.0采用二进制格式，实现方便且健壮。

多路复用： 即连接共享，即每一个请求都是用作连接共享机制的，一个请求对应一个id，这样一个连接上可以有多个请求，每个连接的请求可以随机的混杂在一起，接收方可以根据请求的id将请求再归属到各自不同的服务端请求里面。

header压缩： 如上文中所言，对前面提到过的html1.0的header带有大量信息，而且每次都要重复发送，http2.0使用encoder来减少需要传输的header大学，通讯双方各自cache了一份header fields表，既避免了重复header的传输，又减小了需要传输的大小

服务端推送


### http2.0的多路复用和http1.1中的长连接有什么区别
长连接：若干个请求排队串行化单线程处理，后面的请求等待前面的请求返回才能获得执行机会，一旦有某请求超时，后续请求只能被阻塞。

http2.0多路复用：多个请求可同时在一个连接上并行执行，某个请求任务耗时严重，不会影响到其他连接的正常执行。


### 服务端推送
服务端推送能把客户端所需的资源伴随index.html一起发送到客户端，省去了客户端重复请求的步骤，正因为没有发起请求，建立连接等操作，所以静态资源通过服务端推送的方式可以极大的提升速度。






# 3. http如何实现长连接？在什么情况下超时


如果需要建立长连接，需要设置一个connection字段 Connection:keep-alive 首部字段设置

如果一段时间内这个连接没有http请求发出，那么这个长连接就会被断掉，具体时间长短可以在header当中设置，也就是所谓的超时时间。

服务端和客户端都需要设置为长连接才可以
