# 是什么
DNS是域名系统，在应用层  用于将用户提供的主机名（域名）解析为 IP 地址。

是互联网一项服务，是进行域名和与之对应的ip地址进行转换的服务器

# 域名
域名是一个具有层次的结构，从上到下依次为根域名、顶级域名、二级域名、三级域名...

例如www.xxx.com，www为三级域名、xxx为二级域名、com为顶级域名，系统为用户做了兼容，域名末尾的根域名.一般不需要输入

**域名的每一层都有一个域名服务器：比如根域名服务器，顶级域名服务器，权限域名服务器**
**除此之外，还有默认的本地域名服务器**


# 查询方式
DNS查询方式有两种：
## 递归查询：如果A请求B，那么B作为请求的接收者一定要给A想要的答案

本地域名查询根域名服务器，根域名服务器查询顶级域名服务器，顶级域名服务器查询权限域名服务器，最终根域名拿到最终的ip地址给本地域名服务器

## 迭代查询：如果接收者B没有请求A所需要的准确内容，接收者B将告诉请求者A如何去获得这个内容，但是自己并不去发送请求

本地域名服务器请求根域名服务器，根域名服务器告诉他去对应的顶级域名服务器查找，本地域名服务器去顶级域名服务器查找，顶级域名服务器告诉他去对应的权限域名服务器，权限域名服务器最终得到结果，然后返回给本地域名服务器。


## 在实际查询的时候是两种方式结合查询的
本地域名系统的查询是递归查询



# 域名缓存

在域名服务器解析的时候，使用缓存保存域名和IP地址的映射
计算机中的DNS记录也分成了两种缓存方式：
- 浏览器缓存: 浏览器在获取网站域名的实际ip地址后会对其进行缓存，减少网络请求的损耗
- 操作系统的缓存：操作系统的缓存其实是用户自己配置的hosts文件



# 查询过程
解析域名的过程如下：
- 首先搜索浏览器的DNS缓存，缓存中维护一张域名与ip地址的对应表
- 若没有命中，则继续搜索操作系统的DNS缓存
- 若依然没有命中，则操作系统将域名发送到本地域名服务器，本地域名服务器采用递归查询，查询自己的DNS缓存，查询成功则返回结果
- 若本地域名服务器的DNS缓存没有命中，则本地域名服务器向上级域名服务器进行迭代查询
    - 首先本地域名服务器向根域名服务器发起请求，根域名服务器返回顶级域名服务器地址给本地域名服务器
    - 本地域名服务器拿到这个顶级域名服务器的地址后，就向其发起请求，获得权限域名服务器的地址
    - 本地域名服务器拿到权限域名服务器的地址对其发送请求，最终得到该域名的ip地址

- 本地域名服务器将得到的ip地址返回给操作系统，同时自己将ip地址缓存起来
- 操作系统将ip地址返回给浏览器，同时自己将ip地址缓存起来
- 至此，浏览器就得到了域名对应的ip地址，并将ip地址缓存起来




